{% extends 'base.html' %}

{% block title %}Space Quiz - MeteorMatrix{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto">
    <div class="glass-effect rounded-xl p-8 mb-8">
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold text-cyan-400 neon-text mb-4">üß† Space Knowledge Quiz</h1>
            <p class="text-gray-300">Test your knowledge about asteroids, comets, and space objects!</p>
            <div class="mt-4">
                <span class="text-cyan-300 font-semibold">Score: </span>
                <span id="score" class="text-yellow-400 font-bold">0</span>
                <span class="text-gray-400"> / 10</span>
            </div>
        </div>

        <div id="quiz-container">
            <div id="question-counter" class="text-center mb-6">
                <span class="text-purple-400 font-semibold">Question </span>
                <span id="current-question" class="text-cyan-400 font-bold">1</span>
                <span class="text-gray-400"> of 10</span>
            </div>

            <div id="question-card" class="glass-effect rounded-lg p-6 mb-6">
                <h3 id="question-text" class="text-xl font-semibold text-white mb-6"></h3>
                <div id="options-container" class="space-y-3"></div>
            </div>

            <div class="flex justify-between items-center">
                <button id="prev-btn" class="px-6 py-2 bg-gray-600 text-gray-300 rounded-lg hover:bg-gray-500 transition-all duration-300 disabled:opacity-50" disabled>
                    ‚Üê Previous
                </button>
                <button id="next-btn" class="px-6 py-2 bg-cyan-600 text-white rounded-lg hover:bg-cyan-500 transition-all duration-300">
                    Next ‚Üí
                </button>
                <button id="submit-btn" class="px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-500 transition-all duration-300 hidden">
                    Submit Quiz
                </button>
            </div>
        </div>

        <div id="results-container" class="hidden">
            <div class="text-center">
                <h2 class="text-3xl font-bold text-cyan-400 mb-4">Quiz Complete!</h2>
                <div class="text-6xl mb-4" id="result-emoji">üéâ</div>
                <div class="text-2xl mb-6">
                    <span class="text-white">Your Score: </span>
                    <span id="final-score" class="text-yellow-400 font-bold"></span>
                    <span class="text-gray-400"> / 10</span>
                </div>
                <div id="performance-message" class="text-lg text-gray-300 mb-6"></div>
                <button onclick="location.reload()" class="px-8 py-3 bg-gradient-to-r from-cyan-600 to-blue-600 rounded-lg hover:from-cyan-500 hover:to-blue-500 transition-all duration-300 font-semibold">
                    üîÑ Take Quiz Again
                </button>
            </div>
        </div>
    </div>
</div>

<script>
const quizQuestions = [
    {
        question: "What is the largest asteroid in our solar system?",
        options: ["Ceres", "Vesta", "Pallas", "Hygiea"],
        correct: 0
    },
    {
        question: "Which asteroid is considered potentially hazardous and will make a close approach to Earth in 2029?",
        options: ["Bennu", "Apophis", "Ryugu", "Itokawa"],
        correct: 1
    },
    {
        question: "What is the minimum size for an object to be classified as a Potentially Hazardous Object (PHO)?",
        options: ["50 meters", "100 meters", "140 meters", "200 meters"],
        correct: 2
    },
    {
        question: "The Tunguska event in 1908 was caused by what type of space object?",
        options: ["Large asteroid", "Small comet or asteroid", "Meteorite", "Space debris"],
        correct: 1
    },
    {
        question: "What is the formula used to calculate impact energy?",
        options: ["E = mc¬≤", "E = ¬Ωmv¬≤", "E = mgh", "E = mv"],
        correct: 1
    },
    {
        question: "Which space mission successfully altered an asteroid's orbit in 2022?",
        options: ["OSIRIS-REx", "DART", "Hayabusa2", "Dawn"],
        correct: 1
    },
    {
        question: "What causes a comet to develop a tail?",
        options: ["Solar wind", "Solar radiation heating ice", "Gravitational forces", "Both A and B"],
        correct: 3
    },
    {
        question: "The Chelyabinsk meteor in 2013 injured approximately how many people?",
        options: ["500", "1000", "1500", "2000"],
        correct: 2
    },
    {
        question: "What is the typical speed range of meteors entering Earth's atmosphere?",
        options: ["5-15 km/s", "11-72 km/s", "20-50 km/s", "50-100 km/s"],
        correct: 1
    },
    {
        question: "Which asteroid belt object was the target of NASA's Dawn mission?",
        options: ["Ceres and Vesta", "Pallas and Hygiea", "Eros and Itokawa", "Bennu and Ryugu"],
        correct: 0
    },
    {
        question: "What percentage of Near-Earth Objects are currently tracked by NASA?",
        options: ["About 50%", "About 75%", "Over 90%", "100%"],
        correct: 2
    },
    {
        question: "The asteroid that caused the extinction of dinosaurs impacted Earth approximately how many years ago?",
        options: ["50 million", "66 million", "100 million", "150 million"],
        correct: 1
    },
    {
        question: "What is the main composition of most asteroids?",
        options: ["Ice and dust", "Rock and metal", "Gas and plasma", "Carbon compounds"],
        correct: 1
    },
    {
        question: "Which meteor shower occurs annually in mid-August?",
        options: ["Leonids", "Geminids", "Perseids", "Quadrantids"],
        correct: 2
    },
    {
        question: "What is the approximate diameter of the Chicxulub crater?",
        options: ["100 km", "150 km", "200 km", "250 km"],
        correct: 1
    },
    {
        question: "Which Japanese mission successfully collected samples from asteroid Ryugu?",
        options: ["Hayabusa", "Hayabusa2", "Akatsuki", "BepiColombo"],
        correct: 1
    },
    {
        question: "What is the orbital period of Halley's Comet?",
        options: ["50 years", "66 years", "76 years", "86 years"],
        correct: 2
    },
    {
        question: "The asteroid belt is located between which two planets?",
        options: ["Earth and Mars", "Mars and Jupiter", "Jupiter and Saturn", "Venus and Earth"],
        correct: 1
    },
    {
        question: "What does NEO stand for in astronomy?",
        options: ["New Earth Object", "Near-Earth Object", "Nuclear Earth Object", "Natural Earth Orbit"],
        correct: 1
    },
    {
        question: "Which space object is known for having the most eccentric orbit among the asteroids?",
        options: ["Ceres", "Vesta", "Eros", "Apophis"],
        correct: 3
    }
];

let currentQuestionIndex = 0;
let selectedAnswers = new Array(10).fill(null);
let score = 0;
let shuffledQuestions = [];

function shuffleArray(array) {
    const shuffled = [...array];
    for (let i = shuffled.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
    }
    return shuffled;
}

function initQuiz() {
    shuffledQuestions = shuffleArray(quizQuestions).slice(0, 10);
    currentQuestionIndex = 0;
    selectedAnswers = new Array(10).fill(null);
    score = 0;
    document.getElementById('score').textContent = '0';
    document.getElementById('quiz-container').classList.remove('hidden');
    document.getElementById('results-container').classList.add('hidden');
    displayQuestion();
}

function displayQuestion() {
    const question = shuffledQuestions[currentQuestionIndex];
    document.getElementById('current-question').textContent = currentQuestionIndex + 1;
    document.getElementById('question-text').textContent = question.question;
    
    const optionsContainer = document.getElementById('options-container');
    optionsContainer.innerHTML = '';
    
    question.options.forEach((option, index) => {
        const optionDiv = document.createElement('div');
        optionDiv.className = 'option-item';
        optionDiv.innerHTML = `
            <label class="flex items-center p-4 glass-effect rounded-lg cursor-pointer hover:bg-cyan-500/10 transition-all duration-300">
                <input type="radio" name="answer" value="${index}" class="mr-3 text-cyan-400" ${selectedAnswers[currentQuestionIndex] === index ? 'checked' : ''}>
                <span class="text-white">${option}</span>
            </label>
        `;
        optionsContainer.appendChild(optionDiv);
    });
    
    document.querySelectorAll('input[name="answer"]').forEach(radio => {
        radio.addEventListener('change', function() {
            selectedAnswers[currentQuestionIndex] = parseInt(this.value);
            updateScore();
        });
    });
    
    updateButtons();
}

function updateScore() {
    score = 0;
    for (let i = 0; i < shuffledQuestions.length; i++) {
        if (selectedAnswers[i] === shuffledQuestions[i].correct) {
            score++;
        }
    }
    document.getElementById('score').textContent = score;
}

function updateButtons() {
    const prevBtn = document.getElementById('prev-btn');
    const nextBtn = document.getElementById('next-btn');
    const submitBtn = document.getElementById('submit-btn');
    
    prevBtn.disabled = currentQuestionIndex === 0;
    
    if (currentQuestionIndex === 9) {
        nextBtn.classList.add('hidden');
        submitBtn.classList.remove('hidden');
    } else {
        nextBtn.classList.remove('hidden');
        submitBtn.classList.add('hidden');
    }
}

function nextQuestion() {
    if (currentQuestionIndex < 9) {
        currentQuestionIndex++;
        displayQuestion();
    }
}

function prevQuestion() {
    if (currentQuestionIndex > 0) {
        currentQuestionIndex--;
        displayQuestion();
    }
}

function submitQuiz() {
    updateScore();
    showResults();
}

function showResults() {
    document.getElementById('quiz-container').classList.add('hidden');
    document.getElementById('results-container').classList.remove('hidden');
    
    const finalScore = document.getElementById('final-score');
    const resultEmoji = document.getElementById('result-emoji');
    const performanceMessage = document.getElementById('performance-message');
    
    finalScore.textContent = score;
    
    let emoji, message;
    if (score >= 9) {
        emoji = 'üèÜ';
        message = 'Outstanding! You\'re a space expert!';
    } else if (score >= 7) {
        emoji = 'üåü';
        message = 'Excellent! You have great knowledge of space objects!';
    } else if (score >= 5) {
        emoji = 'üëç';
        message = 'Good job! You know quite a bit about space!';
    } else if (score >= 3) {
        emoji = 'üìö';
        message = 'Not bad! Keep learning about space objects!';
    } else {
        emoji = 'üöÄ';
        message = 'Keep exploring! There\'s so much to learn about space!';
    }
    
    resultEmoji.textContent = emoji;
    performanceMessage.textContent = message;
}

document.getElementById('next-btn').addEventListener('click', nextQuestion);
document.getElementById('prev-btn').addEventListener('click', prevQuestion);
document.getElementById('submit-btn').addEventListener('click', submitQuiz);

initQuiz();
</script>
{% endblock %}